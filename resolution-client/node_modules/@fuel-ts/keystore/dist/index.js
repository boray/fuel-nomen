"use strict";var T=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var P=(r,t)=>{for(var e in t)T(r,e,{get:t[e],enumerable:!0})},D=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of F(t))!U.call(r,n)&&n!==e&&T(r,n,{get:()=>t[n],enumerable:!(o=C(t,n))||o.enumerable});return r};var k=r=>D(T({},"__esModule",{value:!0}),r);var W={};P(W,{bufferFromString:()=>s,decrypt:()=>R,encrypt:()=>O,keyFromPassword:()=>y,randomBytes:()=>m,stringFromBuffer:()=>f});module.exports=k(W);var v=require("@ethersproject/bytes"),w=require("@ethersproject/pbkdf2");var b,h="Node";typeof globalThis<"u"&&globalThis.crypto&&(b=globalThis.crypto,h="Web");if(!b&&typeof require=="function")try{b=require("crypto"),h="Node"}catch(r){console.error("keystore expects a standard Web browser or Node environment.",r)}var a=b,p=h;function s(r,t="base64"){return p==="Node"?Buffer.from(r,t):t==="utf-8"?new TextEncoder().encode(r):new Uint8Array(atob(r).split("").map(e=>e.charCodeAt(0)))}function f(r,t="base64"){return p==="Node"?Buffer.from(r).toString(t):btoa(String.fromCharCode.apply(null,new Uint8Array(r)))}function y(r,t){let e=s(String(r).normalize("NFKC"),"utf-8"),o=(0,w.pbkdf2)(e,t,1e5,32,"sha256");return(0,v.arrayify)(o)}var m=r=>p==="Node"?a.randomBytes(r):a.getRandomValues(new Uint8Array(r));var x="aes-256-ctr";async function B(r,t){let e=m(16),o=m(32),n=y(r,o),u=Uint8Array.from(Buffer.from(JSON.stringify(t),"utf-8")),c=await a.createCipheriv(x,n,e),i=c.update(u);return i=Buffer.concat([i,c.final()]),{data:f(i),iv:f(e),salt:f(o)}}async function N(r,t){let e=s(t.iv),o=s(t.salt),n=y(r,o),u=s(t.data),c=await a.createDecipheriv(x,n,e),i=c.update(u),l=Buffer.concat([i,c.final()]),g=Buffer.from(l).toString("utf-8");try{return JSON.parse(g)}catch{throw new Error("Invalid credentials")}}var S="AES-CTR";async function A(r,t){let e=m(16),o=m(32),n=y(r,o),u=JSON.stringify(t),c=s(u,"utf-8"),i={name:S,counter:e,length:64},l=await a.subtle.importKey("raw",n,i,!1,["encrypt"]),g=await a.subtle.encrypt(i,l,c);return{data:f(g),iv:f(e),salt:f(o)}}async function K(r,t){let e=s(t.iv),o=s(t.salt),n=y(r,o),u=s(t.data),c={name:S,counter:e,length:64},i=await a.subtle.importKey("raw",n,c,!1,["decrypt"]),l=await a.subtle.decrypt(c,i,u),g=new TextDecoder().decode(l);try{return JSON.parse(g)}catch{throw new Error("Invalid credentials")}}async function O(r,t){return p==="Node"?B(r,t):A(r,t)}async function R(r,t){return p==="Node"?N(r,t):K(r,t)}0&&(module.exports={bufferFromString,decrypt,encrypt,keyFromPassword,randomBytes,stringFromBuffer});
//# sourceMappingURL=index.js.map