"use strict";var x=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var W=Object.prototype.hasOwnProperty;var G=(s,t)=>{for(var e in t)x(s,e,{get:t[e],enumerable:!0})},I=(s,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of O(t))!W.call(s,n)&&n!==e&&x(s,n,{get:()=>t[n],enumerable:!(r=w(t,n))||r.enumerable});return s};var T=s=>I(x({},"__esModule",{value:!0}),s);var _={};G(_,{default:()=>F});module.exports=T(_);var A=require("@fuel-ts/merkle-shared");var Z=require("@fuel-ts/merkle-shared");var S=require("@fuel-ts/merkle-shared"),X="0x00",R="0x01";function M(s,t){let e="0x00".concat(s.slice(2)).concat((0,S.hash)(t).slice(2));return[(0,S.hash)(e),e]}function d(s,t){let e="0x01".concat(s.slice(2)).concat(t.slice(2));return[(0,S.hash)(e),e]}function N(s){let t=R.length;return["0x".concat(s.slice(t,t+64)),"0x".concat(s.slice(t+64))]}function B(s){let t=R.length;return["0x".concat(s.slice(t,t+64)),"0x".concat(s.slice(t+64))]}function b(s){return s.slice(0,4)===X}var P=class{SideNodes;NonMembershipLeafData;BitMask;NumSideNodes;SiblingData;constructor(t,e,r,n,f){this.SideNodes=t,this.NonMembershipLeafData=e,this.BitMask=r,this.NumSideNodes=n,this.SiblingData=f}},C=P;var D=class{SideNodes;NonMembershipLeafData;SiblingData;constructor(t,e,r){this.SideNodes=t,this.NonMembershipLeafData=e,this.SiblingData=r}},L=D;var l="0x0000000000000000000000000000000000000000000000000000000000000000";function p(s,t){let e=s.slice(2),r="0x".concat(e.slice(Math.floor(t/8)*2,Math.floor(t/8)*2+2));return(Number(r)&1<<8-1-t%8)>0?1:0}function k(s){let t=0,e=s.length-1,r=s;for(;t<e;)[r[t],r[e]]=[r[e],r[t]],t+=1,e-=1;return r}function v(s,t){let e=0;for(let r=0;r<256&&p(s,r)===p(t,r);r+=1)e+=1;return e}function E(s){let t=[],e=[],r;for(let f=0;f<s.SideNodes.length;f+=1)r=s.SideNodes[f],r===l?t.push(0):(e.push(r),t.push(1));return new C(e,s.NonMembershipLeafData,t,s.SideNodes.length,s.SiblingData)}var H=class{ms;root;constructor(){let t={};this.ms=t,this.root=l,this.ms[this.root]=l}get(t){return this.ms[t]}set(t,e){this.ms[t]=e}setRoot(t){this.root=t}sideNodesForRoot(t,e){let r=[];if(e===l)return[r,l,"",""];let n=this.get(e);if(b(n))return[r,e,n,""];let f,o,i="",c="";for(let h=0;h<256;h+=1){if([f,o]=B(n),p(t,h)===1?(c=f,i=o):(c=o,i=f),r.push(c),i===l){n="";break}if(n=this.get(i),b(n))break}let a=this.get(c);return[k(r),i,n,a]}deleteWithSideNodes(t,e,r,n){if(r===l)return this.root;let[f]=N(n);if(f!==t)return this.root;let o="",i="",c="",a="",h=!1;for(let g=0;g<e.length;g+=1)if(e[g]!==""){if(c=e[g],i==="")if(a=this.get(c),b(a)){o=c,i=c;continue}else i=l,h=!0;!h&&c===l||(h||(h=!0),p(t,e.length-1-g)===1?[o,i]=d(c,i):[o,i]=d(i,c),this.set(o,i),i=o)}return o===""&&(o=l),o}updateWithSideNodes(t,e,r,n,f){let o,i;this.set((0,A.hash)(e),e),[o,i]=M(t,e),this.set(o,i),i=o;let c;if(n===l)c=256;else{let[a]=N(f);c=v(t,a)}c!==256&&(p(t,c)===1?[o,i]=d(n,i):[o,i]=d(i,n),this.set(o,i),i=o);for(let a=0;a<256;a+=1){let h,g=256-r.length;if(a-g<0||r[a-g]==="")if(c!==256&&c>256-1-a)h=l;else continue;else h=r[a-g];p(t,256-1-a)===1?[o,i]=d(h,i):[o,i]=d(i,h),this.set(o,i),i=o}return o}update(t,e){let[r,n,f]=this.sideNodesForRoot(t,this.root),o;e===l?o=this.deleteWithSideNodes(t,r,n,f):o=this.updateWithSideNodes(t,e,r,n,f),this.setRoot(o)}delete(t){this.update(t,l)}prove(t){let[e,r,n,f]=this.sideNodesForRoot(t,this.root),o=[];for(let a=0;a<e.length;a+=1)e[a]!==""&&o.push(e[a]);let i="";if(r!==l){let[a]=N(n);a!==t&&(i=n)}return new L(o,i,f)}proveCompacted(t){let e=this.prove(t);return E(e)}},F=H;0&&(module.exports={});
//# sourceMappingURL=index.js.map